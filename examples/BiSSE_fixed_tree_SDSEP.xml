<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="10000000">
    <state id="state" storeEvery="10000">
      <stateNode idref="Lambda"/>
      <stateNode idref="Mu"/>
      <stateNode idref="FlatQMatrix"/>
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">
        <distribution id="LambdaPrior" spec="beast.math.distributions.Prior" x="@Lambda">
	  	<distr id="Exponential.Lambda" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.2"/>
        </distribution>

        <distribution id="MuPrior" spec="beast.math.distributions.Prior" x="@Mu">
	  	<distr id="Exponential.Mu" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
        </distribution>

        <distribution id="FlatQMatrixPrior" spec="beast.math.distributions.Prior" x="@FlatQMatrix">
	  	<distr id="Exponential.FlatQMatrix" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
        </distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">
	<distribution id="StateDependentSpeciationExtinctionProcess" spec="SSE.StateDependentSpeciationExtinctionProcess" incorporateCladogenesis="false">
	  <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="(((sp93:0.2356622822,(sp94:0.2154739279,sp95:0.2154739279):0.02018835424):12.9847595,((((sp57:2.815062535,sp43:2.815062535):1.780249256,(sp36:4.449415911,((((sp99:0.06034332881,sp100:0.06034332881):0.4473268161,sp88:0.5076701449):1.726055497,sp56:2.233725641):1.371042764,((sp72:1.31183414,sp73:1.31183414):1.545878271,sp42:2.857712411):0.7470559947):0.8446475052):0.1458958804):3.207493326,(((sp27:5.033762494,(((((sp71:1.391331894,((sp86:0.5759627483,sp87:0.5759627483):0.7866153889,(sp89:0.4023765821,sp90:0.4023765821):0.9602015551):0.02875375666):1.595833121,(sp77:0.9006605643,sp78:0.9006605643):2.086504451):0.1392348633,sp41:3.126399879):0.8899363982,(((sp48:2.589801526,sp49:2.589801526):0.1590377796,sp46:2.748839306):0.6512535555,(sp60:2.03018895,((sp79:0.8625209504,(sp101:0.007232857647,sp102:0.007232857647):0.8552880928):0.6584553534,sp69:1.520976304):0.5092126459):1.369903912):0.6162434155):0.07444131832,sp34:4.090777595):0.9429848988):0.6018834209,sp25:5.635645915):0.003042611101,((sp59:2.160114586,(sp70:1.408818523,sp81:1.408818523):0.7512960633):2.006513375,(sp50:2.459826639,sp51:2.459826639):1.706801322):1.472060565):2.164116591):1.673667032,(((sp91:0.321558177,sp92:0.321558177):0.6062021719,sp76:0.9277603489):2.437759666,(sp47:2.651955001,(sp54:2.307131853,sp55:2.307131853):0.3448231482):0.7135650134):6.110952134):3.74394963):2.502755808,(sp15:15.70472892,(((sp37:3.930561202,(sp61:1.91883471,sp62:1.91883471):2.011726492):1.624114024,sp24:5.554675226):7.421080767,(((((sp84:0.6179056665,sp85:0.6179056665):0.2681327966,(sp82:0.8310677522,sp83:0.8310677522):0.05497071083):0.6598028498,sp68:1.545841313):3.050734938,sp29:4.596576251):2.433125762,(((sp96:0.1813892509,(sp97:0.1346470644,sp98:0.1346470644):0.04674218648):1.607626581,sp63:1.789015832):1.762305454,(sp39:3.456648649,sp40:3.456648649):0.0946726372):3.478380726):5.946053981):2.728972922):0.01844867133):0.0;" offset="0" singlechild="false">

	    <taxonset id="TaxonSet" spec="TaxonSet">
	      <taxon id="sp15" spec="Taxon"/>
	      <taxon id="sp24" spec="Taxon"/>
	      <taxon id="sp25" spec="Taxon"/>
	      <taxon id="sp27" spec="Taxon"/>
	      <taxon id="sp29" spec="Taxon"/>
	      <taxon id="sp34" spec="Taxon"/>
	      <taxon id="sp36" spec="Taxon"/>
	      <taxon id="sp37" spec="Taxon"/>
	      <taxon id="sp39" spec="Taxon"/>
	      <taxon id="sp40" spec="Taxon"/>
	      <taxon id="sp41" spec="Taxon"/>
	      <taxon id="sp42" spec="Taxon"/>
	      <taxon id="sp43" spec="Taxon"/>
	      <taxon id="sp46" spec="Taxon"/>
	      <taxon id="sp47" spec="Taxon"/>
	      <taxon id="sp48" spec="Taxon"/>
	      <taxon id="sp49" spec="Taxon"/>
	      <taxon id="sp50" spec="Taxon"/>
	      <taxon id="sp51" spec="Taxon"/>
	      <taxon id="sp54" spec="Taxon"/>
	      <taxon id="sp55" spec="Taxon"/>
	      <taxon id="sp56" spec="Taxon"/>
	      <taxon id="sp57" spec="Taxon"/>
	      <taxon id="sp59" spec="Taxon"/>
	      <taxon id="sp60" spec="Taxon"/>
	      <taxon id="sp61" spec="Taxon"/>
	      <taxon id="sp62" spec="Taxon"/>
	      <taxon id="sp63" spec="Taxon"/>
	      <taxon id="sp68" spec="Taxon"/>
	      <taxon id="sp69" spec="Taxon"/>
	      <taxon id="sp70" spec="Taxon"/>
	      <taxon id="sp71" spec="Taxon"/>
	      <taxon id="sp72" spec="Taxon"/>
	      <taxon id="sp73" spec="Taxon"/>
	      <taxon id="sp76" spec="Taxon"/>
	      <taxon id="sp77" spec="Taxon"/>
	      <taxon id="sp78" spec="Taxon"/>
	      <taxon id="sp79" spec="Taxon"/>
	      <taxon id="sp81" spec="Taxon"/>
	      <taxon id="sp82" spec="Taxon"/>
	      <taxon id="sp83" spec="Taxon"/>
	      <taxon id="sp84" spec="Taxon"/>
	      <taxon id="sp85" spec="Taxon"/>
	      <taxon id="sp86" spec="Taxon"/>
	      <taxon id="sp87" spec="Taxon"/>
	      <taxon id="sp88" spec="Taxon"/>
	      <taxon id="sp89" spec="Taxon"/>
	      <taxon id="sp90" spec="Taxon"/>
	      <taxon id="sp91" spec="Taxon"/>
	      <taxon id="sp92" spec="Taxon"/>
	      <taxon id="sp93" spec="Taxon"/>
	      <taxon id="sp94" spec="Taxon"/>
	      <taxon id="sp95" spec="Taxon"/>
	      <taxon id="sp96" spec="Taxon"/>
	      <taxon id="sp97" spec="Taxon"/>
	      <taxon id="sp98" spec="Taxon"/>
	      <taxon id="sp99" spec="Taxon"/>
	      <taxon id="sp100" spec="Taxon"/>
	      <taxon id="sp101" spec="Taxon"/>
	      <taxon id="sp102" spec="Taxon"/>
	    </taxonset>
	  </tree>

	  <traitStash id="TraitStash" spec="SSE.TraitStash" value="sp15=2,sp24=2,sp25=1,sp27=1,sp29=2,sp34=2,sp36=2,sp37=2,sp39=2,sp40=2,sp41=2,sp42=1,sp43=2,sp46=2,sp47=2,sp48=1,sp49=2,sp50=2,sp51=2,sp54=1,sp55=1,sp56=2,sp57=2,sp59=2,sp60=2,sp61=2,sp62=2,sp63=2,sp68=2,sp69=2,sp70=2,sp71=1,sp72=2,sp73=2,sp76=2,sp77=2,sp78=2,sp79=1,sp81=2,sp82=2,sp83=2,sp84=2,sp85=2,sp86=2,sp87=2,sp88=1,sp89=2,sp90=2,sp91=2,sp92=2,sp93=2,sp94=2,sp95=2,sp96=2,sp97=2,sp98=2,sp99=2,sp100=2,sp101=2,sp102=2" numberOfStates="2">
	    <taxa idref="TaxonSet"/>
	  </traitStash>

	  <lambda id="Lambda" dimension="2" spec="parameter.RealParameter">0.09345285 0.1784429</lambda>
	    
	  <mu id="Mu" dimension="2" spec="parameter.RealParameter">0.02256041 0.001453006</mu>

	  <instantaneousRateMatrix id="InstantaneousRateMatrix" spec="SSE.InstantaneousRateMatrix" numberOfStates="2">
	    <parameter id="FlatQMatrix" dimension="2" lower="0.0" name="flatQMatrix">0.02256041 0.001453006</parameter>
	  </instantaneousRateMatrix>

	  <pi id="Pi" dimension="4" spec="parameter.RealParameter">0.0 0.0 0.5 0.5</pi>
	</distribution> <!-- END SSE -->
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="LambdaScaler" spec="ScaleOperator" parameter="@Lambda" scaleFactor="0.75" weight="3.0"/>
    <operator id="MuScaler" spec="ScaleOperator" parameter="@Mu" scaleFactor="0.75" weight="3.0"/>
    <operator id="FlatQMatrixScaler" spec="ScaleOperator" parameter="@FlatQMatrix" scaleFactor="0.75" weight="3.0"/>

    <logger id="tracelog" fileName="BiSSE_fixed_tree_SDSEP.log" logEvery="5000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
	<log idref="Lambda"/>
        <log idref="Mu"/>
        <log idref="FlatQMatrix"/>
    </logger>

    <logger id="screenlog" logEvery="20000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

    <logger id="treelog.t:firsthalf" fileName="BiSSE_fixed_tree_SDSEP.trees" logEvery="10000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
    </logger>
  </run>
</beast>
