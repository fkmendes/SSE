<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="10000000">
    <state id="state" storeEvery="10000">
      <stateNode idref="Lambda"/>
      <stateNode idref="Mu"/>
      <stateNode idref="FlatQMatrix"/>
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">
        <distribution id="LambdaPrior" spec="beast.math.distributions.Prior" x="@Lambda">
	  	<distr id="Exponential.Lambda" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.2"/>
        </distribution>

        <distribution id="MuPrior" spec="beast.math.distributions.Prior" x="@Mu">
	  	<distr id="Exponential.Mu" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.05"/>
        </distribution>

        <distribution id="FlatQMatrixPrior" spec="beast.math.distributions.Prior" x="@FlatQMatrix">
	  	<distr id="Exponential.FlatQMatrix" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
        </distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">
	<distribution id="HiddenStateDependentSpeciationExtinctionProcess" spec="SSE.HiddenStateDependentSpeciationExtinctionProcess" incorporateCladogenesis="false" useThreads="true" threads="2">
	  <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="((sp29:8.137474467,sp30:8.137474467)nd17:30.24700268,(((((sp48:5.402105488,((sp124:1.018664732,sp125:1.018664732)nd138:1.606821864,sp101:2.625486596)nd111:2.776618892)nd56:4.584657877,(((sp154:0.2177646063,sp155:0.2177646063)nd105:5.849790463,(((sp112:1.43126814,(sp140:0.7342987827,sp141:0.7342987827)nd153:0.6969693572)nd141:0.9491141031,(sp115:1.417008236,sp116:1.417008236)nd142:0.9633740075)nd113:2.645669521,((sp119:1.374152744,((sp123:1.161528315,(sp156:0.2169693247,sp157:0.2169693247)nd158:0.9445589907)nd156:0.06844172339,sp121:1.229970039)nd154:0.1441827049)nd145:3.402326202,(sp134:0.7999468699,sp135:0.7999468699)nd121:3.976532076)nd114:0.2495728181)nd106:1.041503306)nd88:0.8954959965,((sp44:5.717700213,sp45:5.717700213)nd102:0.7482503649,sp41:6.465950578)nd89:0.4971004886)nd57:3.023712299)nd22:7.768104514,sp23:17.75486788)nd18:6.812438184,((((sp148:0.3508828421,sp149:0.3508828421)nd117:4.476470247,(sp89:2.220118812,sp90:2.220118812)nd118:2.607234278)nd92:1.916458117,((sp46:5.703455786,sp47:5.703455786)nd94:0.9538606252,((sp74:3.572682617,(sp88:2.376916155,sp109:2.376916155)nd134:1.195766463)nd100:2.806721363,(((sp93:2.156424967,(sp127:0.8693324494,sp128:0.8693324494)nd144:1.287092518)nd130:1.091453179,sp77:3.247878146)nd128:0.29072309,sp75:3.538601236)nd101:2.840802745)nd95:0.2779124303)nd93:0.08649479507)nd54:17.10606611,sp3:23.84987731)nd11:0.7174287518)nd7:7.688213403,((((sp92:6.423254861,((sp78:3.021666125,(sp110:1.461403375,sp111:1.461403375)nd133:1.56026275)nd109:2.853679848,(((sp150:0.2987227906,sp151:0.2987227906)nd163:0.5316557526,(sp147:0.3511423121,(sp161:0.03533973694,sp162:0.03533973694)nd166:0.3158025752)nd164:0.4792362311)nd161:3.169047861,sp72:3.999426404)nd124:1.875919569)nd99:0.5479088888)nd28:7.992858995,(((sp67:9.162646695,((sp42:6.439881759,(sp70:4.037384327,sp71:4.037384327)nd97:2.402497432)nd75:1.697557689,((sp98:1.916508046,(((sp142:0.4692711425,sp143:0.4692711425)nd159:0.5689860859,(sp152:0.2194673343,sp153:0.2194673343)nd160:0.8187898941)nd150:0.6341362032,(sp136:0.769683178,sp137:0.769683178)nd151:0.9027102536)nd149:0.2441146141)nd123:2.674268822,sp62:4.590776868)nd73:3.54666258)nd68:1.025207246)nd51:4.918044739,((((((sp85:2.419309089,((sp122:1.184967321,(sp145:0.3984616216,sp146:0.3984616216)nd157:0.7865056997)nd155:0.06902974065,sp120:1.253997062)nd140:1.165312027)nd131:0.8024564827,(sp105:1.623097417,sp106:1.623097417)nd132:1.598668155)nd90:3.572772889,(sp63:5.911969357,((sp165:0.005097568572,sp166:0.005097568572)nd146:2.110205749,((sp132:0.814150876,sp133:0.814150876)nd162:0.03853548297,sp129:0.852686359)nd147:1.262616959)nd108:3.79666604)nd91:0.8825691032)nd64:2.797784488,(sp39:6.728293411,sp40:6.728293411)nd66:2.864029537)nd52:0.5792204602,(sp103:1.688168945,sp104:1.688168945)nd53:8.483374463)nd49:3.764087845,(((sp163:0.026855618,sp164:0.026855618)nd84:7.245225471,(sp51:5.247893137,sp52:5.247893137)nd85:2.024187952)nd37:5.952203768,((sp73:3.96200694,((sp144:0.4456111684,(sp158:0.1853886833,sp159:0.1853886833)nd165:0.2602224851)nd135:2.243988122,(sp96:1.959213777,sp97:1.959213777)nd136:0.7303855137)nd126:1.272407649)nd74:4.466088015,((sp167:0.001440511154,sp168:0.001440511154)nd167:0.107632803,sp160:0.1090733141)nd71:8.319021641)nd38:4.796189902)nd36:0.7113463975)nd33:0.1450601792)nd30:0.0438553581,(((sp53:5.216068752,sp54:5.216068752)nd82:2.219906925,(sp117:1.378098738,sp118:1.378098738)nd148:6.057876939)nd76:4.743187952,((((sp86:2.391859515,sp87:2.391859515)nd137:0.2358646323,sp82:2.627724147)nd86:4.435481798,(sp130:0.8367685834,sp131:0.8367685834)nd87:6.226437362)nd58:2.921544484,sp37:9.984750429)nd48:2.1944132)nd31:1.945383162)nd29:0.291567065)nd26:3.401238812,((sp138:0.750877513,sp139:0.750877513)nd77:7.165940136,(sp49:5.360307181,sp50:5.360307181)nd78:2.556510468)nd46:9.900535019)nd19:6.041240195,((sp36:12.43233444,(sp80:2.689910949,sp81:2.689910949)nd43:9.742423496)nd24:5.259159804,(((sp61:4.661228097,(sp83:2.42007668,sp84:2.42007668)nd122:2.241151417)nd62:4.937180587,((sp57:5.103879548,sp69:5.103879548)nd80:2.497382367,((sp113:1.419770714,sp114:1.419770714)nd152:0.173888769,sp107:1.593659483)nd81:6.007602431)nd79:1.997146769)nd55:3.208113605,((sp55:6.196622188,(sp99:1.845696777,sp100:1.845696777)nd104:4.350925411)nd69:2.783753735,sp28:8.980375922)nd40:3.826146366)nd25:4.88497196)nd13:6.167098615)nd6:8.396926604)nd4:6.128957681):0.0;" offset="0" singlechild="false">

	    <taxonset id="TaxonSet" spec="TaxonSet">
	      	      <taxon id="sp3" spec="Taxon"/>
	      <taxon id="sp23" spec="Taxon"/>
	      <taxon id="sp28" spec="Taxon"/>
	      <taxon id="sp29" spec="Taxon"/>
	      <taxon id="sp30" spec="Taxon"/>
	      <taxon id="sp36" spec="Taxon"/>
	      <taxon id="sp37" spec="Taxon"/>
	      <taxon id="sp39" spec="Taxon"/>
	      <taxon id="sp40" spec="Taxon"/>
	      <taxon id="sp41" spec="Taxon"/>
	      <taxon id="sp42" spec="Taxon"/>
	      <taxon id="sp44" spec="Taxon"/>
	      <taxon id="sp45" spec="Taxon"/>
	      <taxon id="sp46" spec="Taxon"/>
	      <taxon id="sp47" spec="Taxon"/>
	      <taxon id="sp48" spec="Taxon"/>
	      <taxon id="sp49" spec="Taxon"/>
	      <taxon id="sp50" spec="Taxon"/>
	      <taxon id="sp51" spec="Taxon"/>
	      <taxon id="sp52" spec="Taxon"/>
	      <taxon id="sp53" spec="Taxon"/>
	      <taxon id="sp54" spec="Taxon"/>
	      <taxon id="sp55" spec="Taxon"/>
	      <taxon id="sp57" spec="Taxon"/>
	      <taxon id="sp61" spec="Taxon"/>
	      <taxon id="sp62" spec="Taxon"/>
	      <taxon id="sp63" spec="Taxon"/>
	      <taxon id="sp67" spec="Taxon"/>
	      <taxon id="sp69" spec="Taxon"/>
	      <taxon id="sp70" spec="Taxon"/>
	      <taxon id="sp71" spec="Taxon"/>
	      <taxon id="sp72" spec="Taxon"/>
	      <taxon id="sp73" spec="Taxon"/>
	      <taxon id="sp74" spec="Taxon"/>
	      <taxon id="sp75" spec="Taxon"/>
	      <taxon id="sp77" spec="Taxon"/>
	      <taxon id="sp78" spec="Taxon"/>
	      <taxon id="sp80" spec="Taxon"/>
	      <taxon id="sp81" spec="Taxon"/>
	      <taxon id="sp82" spec="Taxon"/>
	      <taxon id="sp83" spec="Taxon"/>
	      <taxon id="sp84" spec="Taxon"/>
	      <taxon id="sp85" spec="Taxon"/>
	      <taxon id="sp86" spec="Taxon"/>
	      <taxon id="sp87" spec="Taxon"/>
	      <taxon id="sp88" spec="Taxon"/>
	      <taxon id="sp89" spec="Taxon"/>
	      <taxon id="sp90" spec="Taxon"/>
	      <taxon id="sp92" spec="Taxon"/>
	      <taxon id="sp93" spec="Taxon"/>
	      <taxon id="sp96" spec="Taxon"/>
	      <taxon id="sp97" spec="Taxon"/>
	      <taxon id="sp98" spec="Taxon"/>
	      <taxon id="sp99" spec="Taxon"/>
	      <taxon id="sp100" spec="Taxon"/>
	      <taxon id="sp101" spec="Taxon"/>
	      <taxon id="sp103" spec="Taxon"/>
	      <taxon id="sp104" spec="Taxon"/>
	      <taxon id="sp105" spec="Taxon"/>
	      <taxon id="sp106" spec="Taxon"/>
	      <taxon id="sp107" spec="Taxon"/>
	      <taxon id="sp109" spec="Taxon"/>
	      <taxon id="sp110" spec="Taxon"/>
	      <taxon id="sp111" spec="Taxon"/>
	      <taxon id="sp112" spec="Taxon"/>
	      <taxon id="sp113" spec="Taxon"/>
	      <taxon id="sp114" spec="Taxon"/>
	      <taxon id="sp115" spec="Taxon"/>
	      <taxon id="sp116" spec="Taxon"/>
	      <taxon id="sp117" spec="Taxon"/>
	      <taxon id="sp118" spec="Taxon"/>
	      <taxon id="sp119" spec="Taxon"/>
	      <taxon id="sp120" spec="Taxon"/>
	      <taxon id="sp121" spec="Taxon"/>
	      <taxon id="sp122" spec="Taxon"/>
	      <taxon id="sp123" spec="Taxon"/>
	      <taxon id="sp124" spec="Taxon"/>
	      <taxon id="sp125" spec="Taxon"/>
	      <taxon id="sp127" spec="Taxon"/>
	      <taxon id="sp128" spec="Taxon"/>
	      <taxon id="sp129" spec="Taxon"/>
	      <taxon id="sp130" spec="Taxon"/>
	      <taxon id="sp131" spec="Taxon"/>
	      <taxon id="sp132" spec="Taxon"/>
	      <taxon id="sp133" spec="Taxon"/>
	      <taxon id="sp134" spec="Taxon"/>
	      <taxon id="sp135" spec="Taxon"/>
	      <taxon id="sp136" spec="Taxon"/>
	      <taxon id="sp137" spec="Taxon"/>
	      <taxon id="sp138" spec="Taxon"/>
	      <taxon id="sp139" spec="Taxon"/>
	      <taxon id="sp140" spec="Taxon"/>
	      <taxon id="sp141" spec="Taxon"/>
	      <taxon id="sp142" spec="Taxon"/>
	      <taxon id="sp143" spec="Taxon"/>
	      <taxon id="sp144" spec="Taxon"/>
	      <taxon id="sp145" spec="Taxon"/>
	      <taxon id="sp146" spec="Taxon"/>
	      <taxon id="sp147" spec="Taxon"/>
	      <taxon id="sp148" spec="Taxon"/>
	      <taxon id="sp149" spec="Taxon"/>
	      <taxon id="sp150" spec="Taxon"/>
	      <taxon id="sp151" spec="Taxon"/>
	      <taxon id="sp152" spec="Taxon"/>
	      <taxon id="sp153" spec="Taxon"/>
	      <taxon id="sp154" spec="Taxon"/>
	      <taxon id="sp155" spec="Taxon"/>
	      <taxon id="sp156" spec="Taxon"/>
	      <taxon id="sp157" spec="Taxon"/>
	      <taxon id="sp158" spec="Taxon"/>
	      <taxon id="sp159" spec="Taxon"/>
	      <taxon id="sp160" spec="Taxon"/>
	      <taxon id="sp161" spec="Taxon"/>
	      <taxon id="sp162" spec="Taxon"/>
	      <taxon id="sp163" spec="Taxon"/>
	      <taxon id="sp164" spec="Taxon"/>
	      <taxon id="sp165" spec="Taxon"/>
	      <taxon id="sp166" spec="Taxon"/>
	      <taxon id="sp167" spec="Taxon"/>
	      <taxon id="sp168" spec="Taxon"/>
	    </taxonset>
	  </tree>

	  <hiddenTraitStash id="HiddenTraitStash" spec="SSE.HiddenTraitStash" value="sp3=2,sp23=2,sp28=2,sp29=2,sp30=2,sp36=2,sp37=1,sp39=2,sp40=1,sp41=2,sp42=1,sp44=2,sp45=2,sp46=2,sp47=2,sp48=2,sp49=2,sp50=2,sp51=1,sp52=1,sp53=2,sp54=2,sp55=2,sp57=2,sp61=2,sp62=2,sp63=2,sp67=2,sp69=2,sp70=2,sp71=1,sp72=2,sp73=2,sp74=2,sp75=1,sp77=2,sp78=2,sp80=2,sp81=2,sp82=2,sp83=2,sp84=2,sp85=2,sp86=2,sp87=2,sp88=2,sp89=2,sp90=2,sp92=2,sp93=1,sp96=2,sp97=2,sp98=2,sp99=2,sp100=2,sp101=2,sp103=2,sp104=2,sp105=2,sp106=2,sp107=1,sp109=2,sp110=2,sp111=1,sp112=2,sp113=2,sp114=2,sp115=2,sp116=2,sp117=2,sp118=2,sp119=2,sp120=2,sp121=2,sp122=2,sp123=2,sp124=2,sp125=2,sp127=2,sp128=2,sp129=2,sp130=2,sp131=2,sp132=2,sp133=2,sp134=2,sp135=2,sp136=2,sp137=2,sp138=2,sp139=2,sp140=2,sp141=2,sp142=2,sp143=2,sp144=2,sp145=2,sp146=2,sp147=2,sp148=1,sp149=1,sp150=2,sp151=2,sp152=2,sp153=2,sp154=2,sp155=2,sp156=2,sp157=2,sp158=2,sp159=2,sp160=2,sp161=2,sp162=2,sp163=2,sp164=2,sp165=2,sp166=2,sp167=2,sp168=2" numberOfStates="2" numberOfHiddenStates="1">
	    <taxa idref="TaxonSet"/>
	    <hiddenObsStateMapper idref="StateMapper" />
	  </hiddenTraitStash>

	  <lambdaMuAssigner id="LambdaMuAssigner" spec="SSE.LambdaMuAssigner" totalNumberOfStates="3" nDistinctLambdas="3" nDistinctMus="3" lambdasToStates="0,1,2" musToStates="0,1,2">
	    <pi id="Pi" dimension="6" spec="parameter.RealParameter">0.0 0.0 0.0 0.3333333 0.3333333 0.3333333</pi>
	    <lambda id="Lambda" dimension="3" spec="parameter.RealParameter">0.112770589 0.226607995 0.006693791</lambda>
	    <mu id="Mu" dimension="3" spec="parameter.RealParameter">0.13818947 0.06989352 0.09920653</mu>
	  </lambdaMuAssigner>
	  
	  <hiddenInstantaneousRateMatrix id="HiddenInstantaneousRateMatrix" spec="SSE.HiddenInstantaneousRateMatrix" numberOfStates="2" numberOfHiddenStates="1" disallowDoubleTransitions="true" symmetrifyAcrossDiagonal="-1">
	    <hiddenObsStateMapper id="StateMapper" spec="SSE.HiddenObservedStateMapper" hiddenStates="-1,0" />
	    <parameter id="FlatQMatrix" dimension="4" lower="0.0" name="flatQMatrix">0.05088699 0.20874289 0.12276298 0.07876086</parameter>
	  </hiddenInstantaneousRateMatrix>

	</distribution> <!-- END SSE -->
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="LambdaScaler" spec="ScaleOperator" parameter="@Lambda" scaleFactor="0.75" weight="3.0"/>
    <operator id="MuScaler" spec="ScaleOperator" parameter="@Mu" scaleFactor="0.75" weight="3.0"/>
    <operator id="FlatQMatrixScaler" spec="ScaleOperator" parameter="@FlatQMatrix" scaleFactor="0.75" weight="3.0"/>

    <logger id="tracelog" fileName="HiSSE_fixed_tree_on_HiSSE_HSDSEP.log" logEvery="10000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
	<log idref="Lambda"/>
        <log idref="Mu"/>
        <log idref="FlatQMatrix"/>
    </logger>

    <logger id="screenlog" logEvery="20000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

    <logger id="treelog.t:firsthalf" fileName="HiSSE_fixed_tree_on_HiSSE_HSDSEP.trees" logEvery="10000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
    </logger>
  </run>
</beast>
